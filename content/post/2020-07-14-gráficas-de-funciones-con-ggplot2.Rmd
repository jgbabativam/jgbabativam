---
title: "Graficando funciones con ggplot2"
author: "Giovany Babativa"
tags: ["R", "plot"]
categories: ["R"]
date: 2020-07-14T19:18:43+02:00
lastmod: 2020-07-14T19:18:43+02:00
featured: false
draft: false

# Featured image
# To use, add an image named `featured.jpg/png` to your page's folder.
# Focal points: Smart, Center, TopLeft, Top, TopRight, Left, Right, BottomLeft, Bottom, BottomRight.
image: 
  caption: '[Photo by Matthew Fassnacht on Unsplash](https://unsplash.com/photos/eBbRSsV4JqU)'
  focal_point: ""
  preview_only: no

# Projects (optional).
#   Associate this post with one or more of your projects.
#   Simply enter your project's folder or file name without extension.
#   E.g. `projects = ["internal-project"]` references `content/project/deep-learning/index.md`.
#   Otherwise, set `projects = []`.
projects: []
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

Cuando tenía la necesidad de graficar una función solía recurrir a programas como `MATLAB` o simplemente simulaba algunos datos en `R` y lo hacía de la siguiente manera

```{r simula, echo=TRUE, message=FALSE, warning=FALSE}
library(ggplot2)

df <- data.frame( x = rnorm(1000))

g1 <- ggplot(df, aes(x)) +
  geom_density(aes(color = "estimada"), key_glyph = "path") + theme_classic()
g1
```

Hace poco encontré que la versión `3.3.2` del paquete `ggplot2` permite graficar una función. El usuario puede ingresar la sintaxis de la fórmula o citar el nombre de alguna función de probabilidad conocida. Por ejemplo, en el caso anterior se agregaría la distribución teórica de la siguiente manera
```{r, echo=TRUE}
g2 <- g1 +
      geom_function(aes(color = "teórica"), fun = dnorm)
g2
```

Para dar otro ejemplo, considere una distribución chi-cuadrado con 5 grados de libertad, en este caso se establecen los valores para `x` en el rango de 0 a 30. Adicionalmente, se debe agregar una tilde (`~`) después del igual (`=`) y la variable debe estar antecedida por un punto `.x`.

```{r}
ggplot() +
  xlim(0, 30) +
  geom_function(fun =~ dchisq(.x, df = 5)) + theme_classic()
```

Finalmente, usted puede escribir la sintaxis de cualquier función, si lo prefiere puede usar directamente la fdp, así:

```{r}
ggplot() +
   xlim(-3, 3) +
   geom_function(
     aes(color = "Normal"),
     fun =~ 1/sqrt(2 * pi) * exp(-.x^2/2)
     ) +
   geom_function(
     aes(color = "Laplace"),
     fun =~ 1/2 * exp(-abs(.x))
   ) + theme_classic() +
  ylab("f(x)") + theme(legend.title = element_blank())
```

Por supuesto, puede usarlo en casos que no tienen que ver con probabilidad

```{r}
ggplot() +
  xlim(-10, 10) +
  geom_function(aes(color = "lineal"),
    fun =~ 3*.x + 1 
    ) +
  geom_function(aes(color = "cuadrática"),
    fun =~ 3*.x^2 + .x + 1             
    ) + ylab("f(x)") + theme_classic()
```

